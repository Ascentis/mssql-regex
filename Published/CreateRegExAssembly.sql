/* Source code for the library at: https://github.com/Ascentis/mssql-regex */

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExIsMatch]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExIsMatch
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExMatch]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExMatch
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExMatchIndexed]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExMatchIndexed
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExSplit]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExSplit
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExReplace]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExReplace
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExReplaceCount]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExReplaceCount
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExEscape]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExEscape
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExUnescape]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExUnescape
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExMatches]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExMatches
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExMatchGroup]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExMatchGroup
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExMatchGroupIndexed]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExMatchGroupIndexed
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExMatchesGroup]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExMatchesGroup
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExCachedCount]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExCachedCount
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExClearCache]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExClearCache
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExExecCount]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExExecCount
GO

IF EXISTS (SELECT *
           FROM   sys.objects
           WHERE  object_id = OBJECT_ID(N'[dbo].[RegExResetExecCount]')
                  AND type IN ( N'FN', N'IF', N'TF', N'FS', N'FT' ))
	DROP FUNCTION RegExResetExecCount
GO

IF EXISTS (select *
	from sys.assembly_files f
	full outer join  sys.assemblies a
		on f.assembly_id=a.assembly_id
	where a.name ='Ascentis.RegExSQL')
	DROP ASSEMBLY [Ascentis.RegExSQL]
GO

IF EXISTS(SELECT *
		  from sys.configurations	
		  where name = 'clr strict security' and value = 0)
	EXEC SP_CONFIGURE 'clr strict security', 1
GO

RECONFIGURE
GO

DECLARE @clrName nvarchar(4000) = 'Ascentis.RegExSql';
DECLARE @asmBin varbinary(max) = 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300E24C7FA60000000000000000E00022200B0130000046000000080000000000007265000000200000008000000000001000200000000200000400000000000000060000000000000000C0000000020000B04601000300608500001000001000000000100000100000000000001000000000000000000000001D6500004F000000008000006C0400000000000000000000000000000000000000A000000C00000098640000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E7465787400000078450000002000000046000000020000000000000000000000000000200000602E727372630000006C040000008000000006000000480000000000000000000000000000400000402E72656C6F6300000C00000000A0000000020000004E0000000000000000000000000000400000420000000000000000000000000000000051650000000000004800000002000500843A00009429000009000000000000000000000000000000186400008000000000000000000000000000000000000000000000000000000000000000000000005673290000068001000004731600000A80020000042A00001330020026000000010000117F03000004281700000A260228030000060A0612016F1800000A2D08020673560000060B072A00001B3003006C000000020000117E010000046F2C0000060B7E020000040212006F1900000A2D3E7E010000046F300000060C082D117E020000040212006F1900000A2C02DE1F731A00000A0A7E0200000402066F1B00000ADE0B7E010000046F2B000006DC060DDE0E1201FE16110000026F1C00000ADC092A011C000002002500284D000B0000000002000B00515C000E000000004A03027430000001731D00000A81170000012A001B30020022000000030000110328020000060A06026F1E00000A6F1F00000A0BDE0A062C06066F1C00000ADC072A000001100000020007000F16000A000000001B3003001E000000040000110328020000060A0602046F2000000A0BDE0A062C06066F1C00000ADC072A000001100000020007000B12000A000000001B3004001F000000040000110328020000060A060204056F2100000A0BDE0A062C06066F1C00000ADC072A0001100000020007000C13000A000000001B3002001D000000050000110328020000060A06026F2200000A0BDE0A062C06066F1C00000ADC072A00000001100000020007000A11000A000000001E02282300000A2A1E02282400000A2A1B30020022000000040000110328020000060A06026F1E00000A6F2500000A0BDE0A062C06066F1C00000ADC072A000001100000020007000F16000A000000001B3002003A000000060000110328020000060A06026F2600000A0B04076F2700000A2F0E07046F2800000A6F2500000A2B0572010000700CDE0A062C06066F1C00000ADC082A00000110000002000700272E000A000000001B3002002D000000040000110328020000060A06026F1E00000A6F2900000A046F2A00000A6F2500000A0BDE0A062C06066F1C00000ADC072A00000001100000020007001A21000A000000001B30020045000000060000110328020000060A06026F2600000A0B05076F2700000A2F1907056F2800000A6F2900000A046F2A00000A6F2500000A2B0572010000700CDE0A062C06066F1C00000ADC082A00000001100000020007003239000A000000001B3003004B000000050000110328020000060A06026F2600000A280100002B7E28000004252D17267E27000004FE065A000006732C00000A258028000004280200002B280300002B0BDE0A062C06066F1C00000ADC072A000110000002000700383F000A000000001B3003004500000007000011735C0000060A06047D2A0000040328020000060B07026F2600000A280100002B06FE065D000006732C00000A280200002B280300002B0CDE0A072C06076F1C00000ADC082A00000001100000020014002539000A000000001B30030047000000080000117E010000046F2C0000060A7E020000047E29000004252D17267E27000004FE065B000006732F00000A258029000004280400002B0BDE0E1200FE16110000026F1C00000ADC072A000110000002000B002C37000E000000001B30010034000000090000117E020000046F3100000A0A7E010000046F2D0000060B7E020000046F3200000A060CDE0E1201FE16110000026F1C00000ADC082A01100000020016000E24000E0000000022FE137E030000042A42FE137E0300000416FE1380030000042A1E02283300000A2A000013300300170200000A00001104162F06733400000A7AFE1C380000011E3CAB000000041F1032790269195F0A062C281A06590A04065910020247034740E001000002175810000317581001061759250A2DE6041F103249024B034B40C1010000021A584B031A584B40B4010000021E584B031E584B40A7010000021F0C584B031F0C584B4098010000021F10581000031F10581001041F10591002041F102FB7041E5F39E5000000024B034B4070010000021A584B031A584B4063010000021E581000031E58100138C0000000041F20327B02691D5F0B072C281E07590B040759100202470347403501000002175810000317581001071759250B2DE6041F20324B024C034C4016010000021E584C031E584C4009010000021F10584C031F10584C40FA000000021F18584C031F18584C40EB000000021F20581000031F20581001041F20591002041F202FB5041F105F2C22024C034C40C5000000021E584C031E584C40B8000000021F10581000031F10581001041E5F2C13024C034C409E000000021E581000031E581001041D5F0C0817594507000000020000000A00000012000000240000002C0000003E000000500000002B68024703472E622B62024903492E5A2B5A02490349335402185847031858472E482B48024B034B2E402B40024B034B333A021A5847031A58472E2E2B2E024B034B3328021A5849031A58492E1C2B1C024B034B3316021A5849031A5849330C021C5847031C58473302172A162A72FE1C380000011E2F09021603281A0000062A02166A03281B0000062A13300300DB0100000B00001104162F06733400000A7A02030458342B0204580336250439BE01000002045817590A030458175910010306475203175910010617590A060234EF2AFE1C380000011E3C88000000041F1032600369195F0B072C231A07590B04075910020302475202175810000317581001071759250B2DEB041F10323503024B54031A58021A584B54031E58021E584B54031F0C58021F0C584B54021F10581000031F10581001041F10591002041F102FCB041E5F39B300000003024B54031A58021A584B54021E581000031E5810013898000000041F20326203691D5F0C082C231E08590C04085910020302475202175810000317581001081759250C2DEB041F20323703024C55031E58021E584C55031F1058021F10584C55031F1858021F18584C55021F20581000031F20581001041F20591002041F202FC9041F105F2C1803024C55031E58021E584C55021F10581000031F10581001041E5F2C0E03024C55021E581000031E581001041D5F0D091759450700000001000000060000000B000000180000001D0000002A000000370000002A030247522A030249532A0302495303185802185847522A03024B542A03024B54031A58021A5847522A03024B54031A58021A5849532A03024B54031A58021A584953031C58021C5847522A0013300300390000000C000011FE1C380000011E2F14031E6203600A02061F1062066004281A0000062A031E6203606A0B071F106207600B02071F2062076004281B0000062A00000013300200DE0000000D000011FE1C380000011E3CD100000004162F06733400000A7A041F10324A0269195F0A062C1E1A06590A04065910020203D2520217581000061759250A2DF0041F103224020354021A580354021E580354021F0C580354021F10581000041F10591002041F102FDC041E5F2C12020354021A580354021E581000041D5F1002041759450700000001000000060000000B000000160000001A000000240000002E0000002A0203D2522A0203D1532A0203D15302185803D2522A0203542A020354021A5803D2522A020354021A5803D1532A020354021A5803D153021C5803D2522A000013300200ED0000000D000011FE1C380000011E3FE000000004162F06733400000A7A041F20324B02691D5F0A062C1E1E06590A04065910020203D2520217581000061759250A2DF0041F203225020355021E580355021F10580355021F18580355021F20581000041F20591002041F202FDB041F105F2C0E020355021E580355021F10581000041E5F2C08020355021E581000041759450700000001000000060000000B000000160000001B00000026000000310000002A0203D2522A0203D1532A0203D15302185803D2522A02036D542A02036D54021A5803D2522A02036D54021A5803D1532A02036D54021A5803D153021C5803D2522AAE283500000A6F3600000A183317283500000A6F3700000A6F3800000A1CFE0416FE012B011680040000042A00000013300300570000000E000011160A027B080000040B027C0800000407176007283900000A07330507175F2C30062517580A283F00000607175F2CD3027C0800000407185807283900000A0733C1160A027B090000046F350000062BB202735E0000062A00133003007C0000000F0000110315330902282500000626172A1200032850000006160B027B080000040C027C0800000408176008283900000A08330708175F2D02172A032C40072517580B283F00000608175F2C28027C0800000408185808283900000A083316160B027B09000004120028540000066F360000062C09120028520000062C9D162A13300300760000000E000011027B08000004173310027C080000041617283900000A172E5C027B08000004175F2D06733A00000A7A027B080000040A061FFE5F0B2B187E0500000417588005000004027B080000040A061FFE5F0B027C08000004072C050718592B010706283900000A0633D0072C0B027B090000046F330000062A4A0273370000067D0900000402283300000A2A220216282A0000062A920273370000067D130000040273370000067D1400000402283300000A02037D150000042A00133003003A0000000D000011027B12000004163206733A00000A7A027B120000040A027C120000040620000800805806283900000A0633E3027B150000042D05283B00000A2A0000133003007F0000000E000011160A027B120000040B072000F83F003425027C120000040720000800005807283900000A073308021673600000062A28410000062BCC061F0F2F0C062517580A28400000062BBB0720FF0700005F20FF07000033091F0A283C00000A2BA4027C1200000407175807283900000A073392160A027B130000046F350000062B836E027B150000042D05283D00000A022831000006021773600000062A0013300300760000000D000011027B120000042000F83F005F2D06733A00000A7A027B120000040A027C12000004062000F83F005F2000080000332106200000C03F5F2C0F062000000040602000084000592B100620000000405F2B070620000800005906283900000A0633B4062000F83F005F20000800003307020628320000062A0000133003004D0000000D000011027B12000004163206733A00000A7A027B120000040A027C1200000406200000C03F5F2C0906200000C0BF582B011606283900000A0633D702062832000006027B150000042D05283B00000A2A00000013300300C500000010000011027B120000042000F83F005F2D06733A00000A7A027B150000042D05283D00000A160A027B120000040B072000F83F005F2000080000331E027C120000040720FF07C0BF5F20000000806007283900000A0733CF172A062C07283E0000062BC30720000000405F2D19027C120000040720000000406007283900000A07FE010A2BA107200000C03F5F200000C03F33091F0A283C00000A2B8A027C12000004072000F83F005807283900000A074071FFFFFF027B140000046F35000006022831000006162A00000013300300AB0000000A000011160A027B120000040B072000F83FC05F0C082C08082000000040331D027C120000040720FFFFFFBF5F20000000806007283900000A0733CA2A0720000000C05F2D16027C120000040720000000406007283900000A262BAA061F0F2F0C062517580A28400000062B9907200000C03F5F200000C03F33091F0A283C00000A2B82027C120000040720000040005807283900000A074069FFFFFF160A027B140000046F350000063857FFFFFFC603200000C03F5F2C0C027B140000046F330000062A0320FF0700005F2C12027B130000040320FF0700005F6F340000062A0000001B3003003C00000011000011020A160B061201283E00000A027B16000004153306733F00000A7A02027B1600000417587D1600000402284000000ADE0A072C0606284100000ADC2A01100000020004002D31000A000000001B3003005900000011000011032C55020A160B061201283E00000A02027B1600000403587D16000004027B1600000403341402027B1600000403597D16000004733F00000A7A0317330802284000000ADE1202284200000ADE0A072C0606284100000ADC2A0000000110000002000700474E000A000000001B3003003800000011000011020A160B061201283E00000A2B0702284300000A26027B160000042CF102027B1600000417597D16000004DE0A072C0606284100000ADC2A0110000002000400292D000A000000001B3003005B00000012000011031533080228350000062B4B1200032850000006020B160C071202283E00000A2B130212002854000006284400000A2D04160DDE24027B160000042CE502027B1600000417597D16000004DE0A082C0607284100000ADC172A092A000110000002001800354D000A000000001E02283300000A2A1B3003008800000013000011022D06734500000A7A7E180000040A160B061201283E00000A7E190000046F4600000A2D0728390000062B187E1C0000042D117E19000004166F4700000A166F4800000A7E18000004026F4900000A7E180000046F4A00000A1733157E1A00000420F401000020F40100006F4B00000A267E18000004284000000ADE0A072C0606284100000ADC2A01100000020011006C7D000A0000000013300300420000001400001114FE063C000006734C00000A734D00000A2572030000706F4E00000A0A7E19000004066F4F00000A7E190000046F4600000A17330617801C000004066F5000000A2A00001B3003004E000000130000117E180000040A160B061201283E00000A7E180000046F4A00000A2C187E190000046F4600000A7E1B0000042F072839000006DE197E1A00000415156F4B00000A26DE0A072C0606284100000ADC2A000001100000020008003B43000A0000000013300200420000000D0000117E19000004026F5100000A0A7E19000004066F5200000A062D277E190000046F4600000A2C157E19000004166F4700000A6F5300000A16FE012B0116801C0000042A00001B3003002301000015000011285400000A0A7E180000040C160D081203283E00000A067E19000004166F4700000A333216801C0000042B2A06176F4800000A7E180000042060EA0000284400000A2D0B06283B000006DDD300000006166F4800000A7E180000046F4A00000A2CCA7E180000046F5500000A0B067E19000004166F4700000A330817801C0000042B247E180000046F4A00000A2D187E1C0000042D117E19000004166F4700000A176F4800000ADE0A092C0608284100000ADC00076F5600000ADD47FFFFFF26DD41FFFFFF267E180000040C160D081203283E00000A06283B0000067E180000046F4A00000A2C2C7E190000046F4600000A2D052839000006007E1A00000420F401000020F40100006F4B00000A26DE0326DE00DE0A092C0608284100000ADCDE002A000140000002000E009BA9000A000000000000B4000BBF0006130000010000FA00171101032A0000010200CE004816010A0000000000000600BFC5005D2B000001EE735700000A8018000004735800000A801900000414FE063A000006735900000A141515735A00000A801A000004285B00000A1F145A801B0000042A8E7E1D0000042C091F14285C00000A2B06281D000006267E1E0000041758801E0000042AC602175F2D177E1D0000042C0817285C00000A2B10281D000006262B0802175F283C00000A7E1E0000041758801E0000042AE2021B2F147E1D0000042C0D1F14021C585A285C00000A2B13021F0A2F0816283C00000A2B0617283C00000A7E1E0000041758801E0000042A8A7E1D0000042C0817285C00000A2B06281D000006267E1E0000041758801E0000042A3A285B00000A17FE02801D0000042A22021728440000062A7E02283300000A027E040000042D0A032C07735D00000A2B01147D220000042A9E027B220000042D1302284600000620102700006A5A735E00000A2A027B220000046F5F00000A2ADE027B220000042D230228470000062D07027B200000042A027B20000004284F000006027B2100000459582A027B220000046F6000000A2A1E027B1F0000042A2202037D1F0000042AC20228470000062D27027B220000042C0D027B220000046F6100000A2B0B02284F0000067D21000004021728480000062AFA0228470000062C35027B220000042C0D027B220000046F6200000A2B1902027B20000004284F000006027B2100000459587D20000004021628480000062A96027B220000042C0D027B220000046F6300000A2B0802166A7D20000004021628480000062AEE027B220000042C18027B220000046F6300000A027B220000046F6100000A2B1302166A7D2000000402284F0000067D21000004021728480000062A1E17284E0000062A36027344000006256F490000062A527E040000042D07286400000A6E2A281C0000062A13300200480000000000000003152E0A03162F06733400000A7A0316311C0320C80000002F1402286500000A7D2300000402167D240000042B1202147D2300000402286400000A7D2400000402037D250000042A8A027B230000042C0D027B230000046F6600000A6D2A286400000A027B24000004592A76022855000006163212022851000006022855000006FE0516FE012A162A2A02285500000615FE012A13300200340000001600001102285500000616311B0228510000060A060228550000063702162A02285500000606592A0228550000062C0620FFFFFF7F2A162A1E027B250000042A4202031E286700000A02047D260000042A36027B26000004026F6800000A2A2E735900000680270000042A1E02283300000A2A1E036F2500000A2A360F01286900000A6F6A00000A2A1E02283300000A2A5E036F2900000A027B2A0000046F2A00000A6F2500000A2A2202037D2B0000042A6E027B2B0000042C12027B2B0000046F2700000602147D2B0000042A3E02037D2C00000402047D2D0000042A1E027B2D0000042AC2027B2C0000042C27027B2D0000042C0D027B2C0000046F2F0000062B0B027B2C0000046F2E00000602147D2C0000042A9E022865000006027B2D0000042D06733A00000A7A027B2C0000046F2B00000602167D2D0000042A9E022865000006027B2D0000042C06733A00000A7A027B2C0000046F3000000602177D2D0000042A92027B2C0000042D1B0271110000028C11000002286B00000A6F6C00000A736D00000A7A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C00000068110000237E0000D41100003C0F000023537472696E67730000000010210000200000002355530030210000100000002347554944000000402100005408000023426C6F620000000000000002000001577FA21D090A000000FA0133001600000100000044000000110000002D0000006500000062000000030000006D0000000B0000002900000004000000030000001600000003000000090000000A00000003000000090000000800000001000000040000000500000004000000000070080100000000000600CC051F0C06004F061F0C0600B704790B0F003F0C00000600DF044F090600AF054F09060063054F09060036064F090600EC054F09060005064F090600F6044F090600CB04000C06008F04000C06002A054F0906001105FF0606003909CE0C06004705CE0C06009D042B0F0600320DC6080600DC00420106009900AA0D060047031F0C0A001907750C0A009A051B0B06001C03F20C0E006109AF0C0E00C80EAF0C06002803C608060074041F0C0600C600C6080E007207AF0C0600CD00420106002006C60806006D062B0F06008205CE0C0600C703C6080E009100420106004109C6080600B90042010600C801D2060600B30AD20606008109C6080600020AD2060E007807790B0600DE08C6080600DD0042010600DA01D20606001C07C6080E006C0AAF0C0E002204AF0C0E007109AF0C12001D03780A0600830042010600AB00420106009909C6080600640BC60806009E0DC6080600BD08C60806000C01C60806003109C6080600B509D20606005C0BD2060600E809C6080600D209C6080600660ED20606009807D2060E00050DAF0C0600DE03C608000000000301000000000100010001000000E60100004D000100010081011400E702630C4D000400160080011400DA0B630C4D0004001C0080011400EC0B630C4D0005001F0001011400D907630C4D000500250001011400C107630C4D000A002900000110001404630C4D0016003300810110009508630C4D0017003800800110001D0F630C4D001D003E0001011000A20A630C4D001F00430001011000AC0A630C91002300500004001000C20E00006D0026005600032110003E0100004D0027005800030110004D0000004D002A005C000A011000CF0A000091002B005E000A011000CF0A000091002C0060003100F207CE043100AA08D2041100F50DDF043600DC0AE4041100D60EE7045180C806E70451802307E70401004A04E70421000008EA045180040BE7045180F20AE70451801B08E70451802D08E70451800908E70451803F07E70451808A0AE70451802E07E70401004004E7042100460DEA0421004F0DEA042100B101E4040100600EEE045180A501E7043100EA0CF1043100BA0BFB043100B90A05053100AF0BE70411000B0FE4043100400BE4041100D60EE70401006202E404010021020A05010093030A05010082070D05210082070D052100A40CE7042100900EE7042100BA0712053600FF001A05160025001E051600010027050600720AE7040100BF0A3A050100BF0ACE040100DD02E4045020000000009118550BC40101006820000000009400E3033E0501009C20000000009100A607440502003021000000009600B00E4E05030044210000000096006307560505008421000000009600A8025C050700C021000000009600110E63050A00FC21000000009600700D6B050E0038220000000096009D03AB0010004022000000009600B103AB00110048220000000096005007720512008822000000009600290278051400E022000000009600400A780517002C2300000000960043027F051A0090230000000096004E0C6B051E00F823000000009600580A870520005C24000000009600000E62022300C0240000000096000503620223001025000000009600E60D620223001925000000009600D20D620223002A250000000086184F0B06002300342500000000960044088F0523005727000000009600840A980526007427000000009600DC0E9F0528005C290000000096009008A8052B00A4290000000091000B04B0052E00902A0000000091000B04B80531000000000080009620F000C005340000000000800096209601C4053400892B000000009118550BC401350000000000800096203403C80535000000000080009620C50ACD0537000000000080009620C50AD8053E000000000080009620EF0EE30545000000000080009620E10EEB0548000000000080009620FD0EF4054B00B82B000000008600150BFB054D001C2C000000008600120B00064D00A42C000000008600830D06004E00262D0000000086184F0B06004E00392D0000000086184F0B06004E00422D0000000086184F0B15004E00682D000000008600BD0206004F00B02D0000000086006C0105064F003B2E0000000086005F0405064F00582E000000008600760106004F00DC2E0000000086006A0406004F00382F000000008600C70287004F000C30000000008100FC0306004F00C3300000000081008C0B01004F00F8300000000086002A040600500050310000000086002A040A065000C8310000000086006B0D060051001C320000000086006B0D0006510094320000000086184F0B060052009C3200000000960038080F06520040330000000091007F01C40153009033000000009100A20BDF015300FC330000000091008901160654004C340000000091005D01C4015500BC35000000009118550BC4015500F8350000000096005D0DC40155001C36000000009600C000C80155004E36000000009600EA00C80156008736000000009600590DC4015700AA36000000009118550BC4015700B9360000000086184F0B06005700C2360000000086184F0B15005700E23600000000860815026B0258000A37000000008608C20B710258004237000000008608E306870058004A37000000008108F1061500580053370000000086006C0E0600590084370000000086003B0A06005900C337000000008600400D06005900E937000000008600720E060059002538000000009600A70E1D0659002D38000000009600A70E220659003B380000000091009B0CC0055A0050380000000086184F0B01005A00A438000000008608710328065B00C738000000008608F40187005B00E538000000008608500487005B00F0380000000086088103C2005B003039000000008608840EC2005B0038390000000083184F0B2C065B00493900000000E601380406005D005739000000009118550BC4015D0063390000000086184F0B06005D006B390000000083002F0037065D0073390000000083000B003D065E0081390000000086184F0B06005F008939000000008300630037065F00A1390000000083184F0B4D066000AA3900000000E601380406006100C6390000000083184F0B53066100D639000000008608CF0287006300DE3900000000E6013804060063000F3A000000008600BD0206006300373A000000008600C702870063005F3A00000000810003020600630000000100170A00000100170A00000100B80E020002006B0B00000100990E00000200170A00000100990E00000200170A00000300880D00000100990E00000200170A00000300880D00000400600E00000100990E00000200170A00000100990E00000100990E00000100990E00000200170A00000100990E00000200170A00000300BC0E00000100990E00000200170A00000300720A00000100990E00000200170A00000300720A00000400BC0E00000100990E00000200170A00000100990E00000200170A00000300720A000001003301000002003C01000003002B0E000001007F0E000002009107000001006801000002007F0E000003002B0E000001007F0E00000200BA06000003002B0E000001007F0E00000200BA06000003002B0E000001007F0E00000200BA06000003002B0E00200000000000200000000000000100400300200000000000000100680300000200F208000003009F0200000400D10300000500940A02000600E70800200000000000000100680300000200F208000003009F0200000400D10300000500940A02000600E708000001007F0E00000200910700000300BA06000001007F0E000002006801000003009107000001007F0E000002009107000001006F0B00000100B101000001004A0400000100600E000001006F0B000001004809000001009F0E00000100CF0100000100600E00000100430E000001001F0A00000100BA06000001001F0A000001006F0B00000100170A00000200BB0700000100DC0800000100BB0700000100DC0800000100BF0A00000100BF0A00000200DD020D007100100071001100710009004F0B010011004F0B060019004F0B0A0029004F0B100031004F0B100039004F0B100041004F0B100049004F0B100051004F0B100059004F0B100061004F0B150069004F0B100071004F0B100079004F0B100089004F0B1A0091004F0B0600C1004F0B0600E9004F0B060009014F0B150011014F0B060019014F0B1A000C004F0B06007901940D38001400340A45001C00AE066A0014004F0B06001C00D6017300E10038040600B9004F0B1000D9007207810089011D0D8700D900B5029100D900B5029700D9007D0DA500D900AA03AB00D900BE03AB009101A406B000D9005B0CBC00D100C80DC200D100B408C600F900120DCC009901B408D200A1017A0ED90024004F0BF300A101390DF900A101CE0E19012C004F0BF300A101DA084C013400C80DC2003400840A060099004F0B0600B9014F0B0600C9011F099E01D101CD08A401D1012D09AA01E101360BC2007901F502B501E9014F0B06004101F908C40141012E0AC80141010B09C401F101150BD801F9014F0B0600F1013204DF01F101830DDF01F1014D08DF01F1016B0DE401F1016B0DF20101024F0B06003C00C80DC2003C00B4080D0241018E02150044009C061C024400C80DC2004901EE02220209024F0BF30041014F0B2E024101520310003C00D6011C0241016C0E06003C00C00635023C00290D010041017D0287004101BD014D0244009406530231011503060044004F0B06003C004F0B060011024F0BF30049014F0B5802C9014D0E62024101670DC80161014F0B060069014F0B6602610115026B026101C20B710261016C0E060061013B0A06006101400D0600C901350E62026101A70E750261018A0C7102D9004F0B7F0214008C071C024C00A40694021400C80DC2009900DB03990221025B03B00051014F0B1000080018004A0308001C004F0308002800540308002C005903080030005E0308003400630308003800680308003C006D03080040007203080044004A0308005C007703270083004A032E000B0070062E00130079062E001B0098062E002300A1062E002B00AF062E00330006072E003B000C072E004300A1062E004B002C072E00530006072E005B0006072E00630044072E006B006E072E0073007B0763009B0006076300A3004A038300A3004A0389009B000607A0008B00C907A300A3004A03C0008B00C907E0008B00C90700018B00EE0720018B00C90740018B00C90760018B00C90780018B00C907A0018B00C907C0018B00C907C30193004A03E0018B00EE07E30193004A0300028B00EE0720028B00C90740028B00C90760028B00C90780028B00C907E10393004A03E00893004A03000993004A036900CC046B00CC046F00CC047D00CC04080006007C03060018001C0406001C001C042D004C007B008B009E00B4002B0134016E0187018D0195019A01B001BD01CD01D201E901F80128023B027B020B0001000C00040011000900000019025A060000C60B60060000F50664060000750368060000F8016406000054046406000085036C060000880E6C060000D3026406020045000300020046000500020047000700010048000700020051000900020052000B00020053000D00020054000F0002005500110002006100130063085608860820003E005E00EB003A01750104021302870201013900F000010001013B009601010001013F003403010044014100C50A020044014300C50A020001014500EF0E030001014700E10E030001014900FD0E030004800000010000000000020001000000A802170100000400000000000000000000009F023501000000000400000000000000000000009F022901000000000400000000000000000000009F02C608000000000400000000000000000000009F02F003000000000D0002000E0002000F00020010000600110007005700E6005B0013015D00270161005F0100000000003C3E395F5F32305F30003C5265674578436163686564436F756E743E625F5F32305F30003C3E395F5F31385F30003C5265674578436F6D70696C65644D6174636865733E625F5F31385F30003C3E635F5F446973706C6179436C61737331395F30003C5265674578436F6D70696C65644D61746368657347726F75703E625F5F300049456E756D657261626C656031005175657565603100436F6E63757272656E74537461636B60310049436F6C6C656374696F6E6031004C6973746031005370696E310046756E636032004B657956616C7565506169726032004944696374696F6E6172796032005370696E32004765745469636B436F756E743634003C3E39003C4D6F64756C653E00506C6174666F726D494400417363656E7469732E526567457853514C0053797374656D2E44617461006D73636F726C6962003C3E630053797374656D2E436F6C6C656374696F6E732E47656E657269630054687265616446756E630073726300456E74657252656164004578697452656164004164645468726561640052656D6F766554687265616400537769746368546F546872656164004D735065725468726561640063726F7373546872656164006765745F43757272656E74546872656164007468726561640041646400496E7465726C6F636B6564005265674578436F6D70696C6564006765745F48617345787069726564004173736572744E6F74446973706F736564006765745F456C617073656400656C6170736564005265674578436F6D70696C65644D61746368496E6465786564005265674578436F6D70696C65644D6174636847726F7570496E6465786564003C497352756E6E696E673E6B5F5F4261636B696E674669656C64006765745F49734261636B67726F756E64007365745F49734261636B67726F756E640070617373776F7264005265674578436F6D70696C65645265706C61636500446F776E67726164650055706772616465006765745F57726974654D6F64650077726974654D6F646500556E73616665004368616E676500436F6D7061726545786368616E6765005265674578436C656172436163686500496E766F6B650049456E756D657261626C650049446973706F7361626C6500436C6F736548616E646C650068616E646C65004973566F6C6174696C65007365745F4E616D65006765745F46756C6C4E616D6500757365724E616D65006765745F456C617073656454696D65006765745F52656D61696E696E6754696D6500737461727454696D65005265674578436F6D70696C6564457363617065005265674578436F6D70696C6564556E6573636170650056616C756554797065006C6F676F6E547970650047657454797065005265676578416371756972650053797374656D2E436F726500456E7465725772697465436F72650046696C6C436F7265004661737453656D6170686F726500436170747572650052656C656173650050756C736500446973706F7365006C6F636B5374617465007374617465006765745F4973496E66696E69746500456E74657257726974650045786974577269746500436F6D70696C657247656E657261746564417474726962757465004775696441747472696275746500556E76657269666961626C65436F64654174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E4174747269627574650053656375726974795065726D697373696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500486F737450726F74656374696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500434C53436F6D706C69616E7441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465005375707072657373556E6D616E61676564436F64655365637572697479417474726962757465004465717565756500456E7175657565006765745F56616C75650054727947657456616C75650076616C756500496E6465784F66004F776E6564466C61670053797374656D2E546872656164696E67006765745F497352756E6E696E67007365745F497352756E6E696E670053797374656D2E52756E74696D652E56657273696F6E696E670053716C537472696E67004F6E6557616974696E67004F6E6552656164657257616974696E67004F6E6557726974657257616974696E67005265674578436F6D70696C65644D61746368005265674578436F6D70696C656449734D617463680053746F7077617463680073746F7077617463680050757368006C656E6774680054696D657243616C6C6261636B00476574506F6F6C65645265676578537461636B005F737461636B0055706772616461626C655265616457726974654C6F636B0043726F73735468726561644578636C75736976654C6F636B005265676578506F6F6C4C6F636B00776169744C6F636B0052656164657257616974696E674D61736B0057726974657257616974696E674D61736B005265616465724D61736B00456E71756575655461736B00417265457175616C0050756C7365416C6C0061647661706933322E646C6C006B65726E656C33322E646C6C00417363656E7469732E526567457853514C2E646C6C006E74646C6C2E646C6C0046696C6C00466F726567726F756E64546872656164506F6F6C005265676578506F6F6C006765745F4974656D004F7065726174696E6753797374656D006765745F506C6174666F726D0053756D0054696D655370616E006C6F676F6E546F6B656E00646F6D61696E00456E64437269746963616C526567696F6E00426567696E437269746963616C526567696F6E006765745F4F5356657273696F6E006765745F56657273696F6E005365637572697479416374696F6E00616374696F6E0053797374656D2E5265666C656374696F6E004D61746368436F6C6C656374696F6E0047726F7570436F6C6C656374696F6E004F626A656374446973706F736564457863657074696F6E00417267756D656E744F75744F6652616E6765457863657074696F6E0053796E6368726F6E697A6174696F6E4C6F636B457863657074696F6E00417267756D656E744E756C6C457863657074696F6E00496E76616C69644F7065726174696F6E457863657074696F6E0054687265616441626F7274457863657074696F6E007061747465726E00726571756972654C6F6E6752756E00536C65657000547279506F700053746F70005265674578436F6D70696C65644D6174636847726F7570005265674578436F6D70696C65644D61746368657347726F75700067726F75700053797374656D2E4C696E7100436C656172004F6E65526561646572006C6F676F6E50726F7669646572005469636B54696D65720054696D656F757454696D65720074696D6572006F776E6572004C6F676F6E55736572004C6F636B52656C656173657200497357696E646F777356697374614F724C61746572005265736572766564466F72577269746572004F776E6564427957726974657200547279456E746572004D6963726F736F66742E53716C5365727665722E536572766572006765745F4D616A6F72004D756C746950726F636573736F72002E63746F72002E6363746F72004D6F6E69746F7200496E74507472007374720074696D656F75744D730053797374656D2E446961676E6F73746963730052656C6561736557616974696E675468726561647300436865636B54687265616473004D6178546872656164730074687265616473006765745F456C61707365644D696C6C697365636F6E647300536166654E61746976654D6574686F647300556E736166654E61746976654D6574686F64730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573005265674578436F6D70696C65644D617463686573004164616D4D696C2E5574696C69746965730053797374656D2E446174612E53716C5479706573006765745F456C61707365645469636B73004765745469636B730073746172745469636B730053797374656D2E546578742E526567756C617245787072657373696F6E730053797374656D2E53656375726974792E5065726D697373696F6E7300616374696F6E730053797374656D2E436F6C6C656374696F6E730052656765784F7074696F6E73006765745F47726F757073006765745F537563636573730052656D6F76654174004F626A6563740053656C656374005265736574007265616457616974007772697465576169740056657279427269656657616974005370696E57616974005265674578436F6D70696C656453706C69740045786974007265706C6163656D656E7400496E6372656D656E7400456E7669726F6E6D656E740053797374656D2E436F6C6C656374696F6E732E436F6E63757272656E74006765745F436F756E74005265674578526573657445786563436F756E7400526567457845786563436F756E74005F65786563436F756E74005265674578436163686564436F756E74005265674578436F6D70696C65645265706C616365436F756E740062797465436F756E74006765745F5469636B436F756E74007370696E436F756E74006765745F50726F636573736F72436F756E7400636F756E74005468726561645374617274005265737461727400436173740064657374006765745F54696D656F7574005F74696D656F757400696E70757400636F6E746578740053746172744E65770046696C6C526F7700726F7700696E64657800506F6F6C6564526567657800546F41727261790064756D6D7900436F70790052746C4D6F76654D656D6F72790052746C46696C6C4D656D6F72790052746C5A65726F4D656D6F7279006669727374546872656164497342757379005468726561645574696C6974790053797374656D2E536563757269747900000001001B57006F0072006B00650072002000540068007200650061006400000037B2CA40C9CE9640ADCCC618C1DA2B3E00042001010803200001052001011111042001010E04200101020520010111410C151280B9020E1512550112340A0702151255011234123405000108100806151255011234062001021013001107041512550112341144021512550112340B151251020E1512550112340820020213001013010720020113001301050702123402052001127D0E0320000205070212340E0520020E0E0E0620030E0E0E08060702123412650520011D0E0E0400010E0E0320000E070703123412690E05200112690E03200008052001127D080520001280CD0620011280C5080C100101151280D5011E001265040A01127D0715127902127D0E052002011C1819100202151280D5011E01151280D5011E00151279021E001E01050A02127D0E0D1001011D1E00151280D5011E00030A010E080703123C12341265050702114408111512790215118081020E151255011234081210010208151280D5011E00151279021E00080E0A0115118081020E1512550112340607030811440811151280D90115118081020E1512550112340507030808080707040F05080808040702080A030701080500001280E90520001180ED0520001280F104070208080700030810080808060703113008080300000104000101080407020208050702122002060002011C1002040001011C040001021C080704113012200202050002021C080B0702151280950112809902081512809D011280A10520011300080815128095011280990520010113000520020208080507011280A1062001011281050520010813001107041280A11280991512809501128099020500001280A10420001300092004011281091C080803000008042001010A0520001180B50320000A0500001280B103070109072002010E11810D0C15118081020E151255011234042000130105200012811108B77A5C561934E08980A00024000004800000940000000602000000240000525341310004000001000100FB9E4120118BC09271D4E040E3E458EC36CA202C6BD68AC96BB205FEAB82016B9F0060CF3B7C48FE32D100E6665381CA72EE115798079CB3ABF0C1914FF04590733A8B23E4E5103C532DF7D32E241E4D6170E06675240D008955E661AB9A7DA815D6E3086CE112FF90392E84F58EED4454439083B670906374EFE5B9B1938BB60401000000040200000004000000800400000040040000C03F0400F83F0004FF0700000400004000040008000004F4010000809E2E01808453797374656D2E53656375726974792E5065726D697373696F6E732E53656375726974795065726D697373696F6E4174747269627574652C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038391501540210536B6970566572696669636174696F6E0180AE2E01808053797374656D2E53656375726974792E5065726D697373696F6E732E486F737450726F74656374696F6E4174747269627574652C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D62373761356335363139333465303839290254020F53796E6368726F6E697A6174696F6E0154021145787465726E616C546872656164696E670101020306121C0C06151251020E15125501123404061F5908020602020608030612200206090906151280950112809909061512809D011280A104061280A502060A04061280B1070615125501123403061238080615127902127D0E12061512790215118081020E151255011234080306121805000112340E0900011512550112340E070002011C10115D050002020E0E0600030E0E0E0E0700040E0E0E0E0806000212650E0E0500020E0E0E0600030E0E0E080700040E0E0E080807000312650E0E08080003020F010F0108060002010F0108080003010F010F0108070003010F010508070003010F010908070003010F010B080300000A0300000204000102180A0006020E0E0E080810180A0006020E0E1808081018070003010F011805080003010F010F0118060002010F0118042000114004200102080420001144042001010906000101128099060001011280A1040000122C050001122C02032000090A2002010E1512550112340520010E127D0F20010815118081020E15125501123405200101121806200201121C020528001180B50328000A0328000203280009032800080801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D010008526567457853514C000056010051436F6C6C656374696F6E206F662052656745782066756E6374696F6E7320746F2075736520696E204D5353514C202D2066756E6374696F6E732075736520526567457820436F6D70696C6564206D6F646500000501000000001F01001A417363656E74697320436F72706F726174696F6E2C20496E632E000017010012436F7079726967687420C2A920203230323000002901002433323930653164342D643931642D346635382D623636652D37383936346665333330653600000C010007312E302E302E3200004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E362E310100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E362E31240100020054020F497344657465726D696E69737469630154020949735072656369736501640100040054020F497344657465726D696E69737469630154020949735072656369736501540E1146696C6C526F774D6574686F644E616D650746696C6C526F77540E0F5461626C65446566696E6974696F6E11535452204E56415243484152284D41582900A1E960911AFE5EAEE33D0D94639E034C68F4E160176897928F2380949991F5067F156AC4DEDCA4213CB97ED7CFFC62D4F786DC4F2E45E3CFBD4B8C7DBFAA0ADB6AF660F77DA635F190CA1400027284244C7493F13D4A911B48C1EF122227F29E97855FDD1A1BD2E6D5B00A3B66A3E272C28597EB869B1B7D156043696807EB7700000000E203499E00000000020000004D000000D0640000D046000000000000000000000000000010000000000000000000000000000000525344533692B91855705E4D8329118C4E71C93401000000583A5C4465765C6D7373716C2D72656765785C6F626A5C52656C656173655C417363656E7469732E526567457853514C2E706462004565000000000000000000005F65000000200000000000000000000000000000000000000000000051650000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058800000100400000000000000000000100434000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000200000000000100020000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B00470030000010053007400720069006E006700460069006C00650049006E0066006F0000004C0300000100300030003000300030003400620030000000BC005200010043006F006D006D0065006E0074007300000043006F006C006C0065006300740069006F006E0020006F0066002000520065006700450078002000660075006E006300740069006F006E007300200074006F002000750073006500200069006E0020004D005300530051004C0020002D002000660075006E006300740069006F006E0073002000750073006500200052006500670045007800200043006F006D00700069006C006500640020006D006F0064006500000056001B00010043006F006D00700061006E0079004E0061006D0065000000000041007300630065006E00740069007300200043006F00720070006F0072006100740069006F006E002C00200049006E0063002E00000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E000000000052006500670045007800530051004C0000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00320000004C001600010049006E007400650072006E0061006C004E0061006D006500000041007300630065006E007400690073002E0052006500670045007800530051004C002E0064006C006C0000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003200300000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000005400160001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000041007300630065006E007400690073002E0052006500670045007800530051004C002E0064006C006C000000320009000100500072006F0064007500630074004E0061006D0065000000000052006500670045007800530051004C0000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003200000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0032000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000C000000743500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;
DECLARE @hash varbinary(64);

SELECT @hash = HASHBYTES('SHA2_512', @asmBin);

IF EXISTS(SELECT * from sys.trusted_assemblies
	  	  WHERE description = 'Ascentis.RegExSql')
BEGIN
	DECLARE @UnTrustAssembliesCmd nvarchar(max) = '';

	SELECT @UnTrustAssembliesCmd = @UnTrustAssembliesCmd + 'EXEC sys.sp_drop_trusted_assembly @hash = ' + CONVERT(varchar(max), hash, 1) + ';' 
	FROM sys.trusted_assemblies
	WHERE description = 'Ascentis.RegExSql';

	EXEC sp_executesql @UnTrustAssembliesCmd
END

EXEC sys.sp_add_trusted_assembly @hash = @hash, @description = @clrName;

CREATE ASSEMBLY [Ascentis.RegExSQL]
FROM @asmBin
WITH PERMISSION_SET = UNSAFE
GO

CREATE FUNCTION RegExIsMatch( 
  @input nvarchar(max),
  @pattern nvarchar(max)  
)
RETURNS bit EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledIsMatch
GO

CREATE FUNCTION RegExMatch( 
  @input nvarchar(max),
  @pattern nvarchar(max)  
)
RETURNS nvarchar(max) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledMatch
GO

CREATE FUNCTION RegExMatchIndexed( 
  @input nvarchar(max),
  @pattern nvarchar(max),
  @index int
)
RETURNS nvarchar(max) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledMatchIndexed
GO

CREATE FUNCTION RegExMatchGroup( 
  @input nvarchar(max),
  @pattern nvarchar(max),
  @group int
)
RETURNS nvarchar(max) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledMatchGroup
GO

CREATE FUNCTION RegExMatchGroupIndexed( 
  @input nvarchar(max),
  @pattern nvarchar(max),
  @group int,
  @index int
)
RETURNS nvarchar(max) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledMatchGroupIndexed
GO

CREATE FUNCTION RegExReplace( 
  @input nvarchar(max),
  @pattern nvarchar(max),
  @replacement nvarchar(max)
)
RETURNS nvarchar(max) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledReplace
GO

CREATE FUNCTION RegExReplaceCount( 
  @input nvarchar(max),
  @pattern nvarchar(max),
  @replacement nvarchar(max),
  @count int
)
RETURNS nvarchar(max) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledReplaceCount
GO

CREATE FUNCTION RegExSplit(
	@input nvarchar(max),
	@pattern nvarchar(max)
)
RETURNS TABLE (ITEM NVARCHAR(MAX)) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledSplit
GO

CREATE FUNCTION RegExEscape(
	@input nvarchar(max)
)
RETURNS NVARCHAR(MAX) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledEscape
GO

CREATE FUNCTION RegExUnescape(
	@input nvarchar(max)
)
RETURNS NVARCHAR(MAX) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledUnescape
GO

CREATE FUNCTION RegExMatches(
	@input nvarchar(max),
	@pattern nvarchar(max)
)
RETURNS TABLE (ITEM NVARCHAR(MAX)) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledMatches
GO

CREATE FUNCTION RegExMatchesGroup(
	@input nvarchar(max),
	@pattern nvarchar(max),
	@group int
)
RETURNS TABLE (ITEM NVARCHAR(MAX)) EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCompiledMatchesGroup
GO

CREATE FUNCTION RegExCachedCount()
RETURNS INT EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExCachedCount
GO

CREATE FUNCTION RegExClearCache()
RETURNS INT EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExClearCache
GO

CREATE FUNCTION RegExExecCount()
RETURNS INT EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExExecCount
GO

CREATE FUNCTION RegExResetExecCount()
RETURNS INT EXTERNAL NAME [Ascentis.RegExSQL].RegExCompiled.RegExResetExecCount
GO
